---
title: "Основы обработки данных с помощью R и Dplyr"
format: 
  md:
    output-file: README.md
---

## Цель работы

 1. Развить практические навыки использования языка программирования R для
 обработки данных
 2. Закрепить знания базовых типов данных языка R
 3. Развить практические навыки использования функций обработки данных пакета
 dplyr – функции 
select(), filter(), mutate(), arrange(), group_by()

## Исходные данные

1. Rstudio Desktop
2. Наше рабочее окружение
       
## План

1. Проанализировать встроенный в пакет dplyr набор данных языка R
2. Ответить на вопросы

## Шаги: 
```{r}
sessionInfo()
```

Проанализировать встроенный в пакет dplyr набор данных starwars с помощью
языка R и ответить на вопросы:

  1. Сколько строк в датафрейме?
  
```{r}
nrow(starwars)
```

  2. Сколько столбцов в датафрейме?

> starwars %>% ncol()
[1] 14

  3. Как просмотреть примерный вид датафрейма?

```{r}
starwars %>% glimpse()
```

  4. Сколько уникальных рас персонажей (species) представлено в данных?

> starwars %>%
+     distinct(species) %>%
+     nrow()
[1] 38

  5. Найти самого высокого персонажа.

> starwars %>%
+     filter(height == max(height, na.rm = TRUE)) %>%
+     select(name, height)
  name        height
1 Yarael Poof    264

  6. Найти всех персонажей ниже 170

> starwars %>%
+     filter(height < 170) %>%
+     select(name, height)
   name                  height
   <chr>                  <int>
 1 C-3PO                    167
 2 R2-D2                     96
 3 Leia Organa              150
 4 Beru Whitesun Lars       165
 5 R5-D4                     97
 6 Yoda                      66
 7 Mon Mothma               150
 8 Wicket Systri Warrick     88
 9 Nien Nunb                160
10 Watto                    137

  7. Подсчитать ИМТ (индекс массы тела) для всех персонажей. ИМТ подсчитать по
формуле.

> starwars %>% mutate(bmi = mass / (height / 100)^2)
   name               height  mass hair_color    skin_color  eye_color birth_year sex    gender    homeworld species films  vehicles  starships   bmi
 1 Luke Skywalker        172    77 blond         fair        blue            19   male   masculine Tatooine  Human   <chr>  <chr [2]> <chr [2]>  26.0
 2 C-3PO                 167    75 NA            gold        yellow         112   none   masculine Tatooine  Droid   <chr>  <chr [0]> <chr [0]>  26.9
 3 R2-D2                  96    32 NA            white, blue red             33   none   masculine Naboo     Droid   <chr>  <chr [0]> <chr [0]>  34.7
 4 Darth Vader           202   136 none          white       yellow          41.9 male   masculine Tatooine  Human   <chr>  <chr [0]> <chr [1]>  33.3
 5 Leia Organa           150    49 brown         light       brown           19   female feminine  Alderaan  Human   <chr>  <chr [1]> <chr [0]>  21.8
 6 Owen Lars             178   120 brown, grey   light       blue            52   male   masculine Tatooine  Human   <chr>  <chr [0]> <chr [0]>  37.9
 7 Beru Whitesun Lars    165    75 brown         light       blue            47   female feminine  Tatooine  Human   <chr>  <chr [0]> <chr [0]>  27.5
 8 R5-D4                  97    32 NA            white, red  red             NA   none   masculine Tatooine  Droid   <chr>  <chr [0]> <chr [0]>  34.0
 9 Biggs Darklighter     183    84 black         light       brown           24   male   masculine Tatooine  Human   <chr>  <chr [0]> <chr [1]>  25.1
10 Obi-Wan Kenobi        182    77 auburn, white fair        blue-gray       57   male   masculine Stewjon   Human   <chr>  <chr [1]> <chr [5]>  23.2

  8. Найти 10 самых “вытянутых” персонажей. “Вытянутость” оценить по отношению
массы (mass) к росту (height) персонажей.

> starwars %>%
+     mutate(stretch = mass / height) %>%
+     arrange(desc(stretch)) %>%
+     head(10) %>%
+     select(name, mass, height, stretch)
   name                   mass height stretch
   <chr>                 <dbl>  <int>   <dbl>
 1 Jabba Desilijic Tiure  1358    175   7.76 
 2 Grievous                159    216   0.736
 3 IG-88                   140    200   0.7  
 4 Owen Lars               120    178   0.674
 5 Darth Vader             136    202   0.673
 6 Jek Tono Porkins        110    180   0.611
 7 Bossk                   113    190   0.595
 8 Tarfful                 136    234   0.581
 9 Dexter Jettster         102    198   0.515
10 Chewbacca               112    228   0.491

  9. Найти средний возраст персонажей каждой расы вселенной Звездных войн.

> starwars %>%
+     group_by(species) %>%
+     summarise(avg_height = mean(height, na.rm = TRUE))
   species   avg_height
   <chr>          <dbl>
 1 Aleena           79 
 2 Besalisk        198 
 3 Cerean          198 
 4 Chagrian        196 
 5 Clawdite        168 
 6 Droid           131.
 7 Dug             112 
 8 Ewok             88 
 9 Geonosian       183 
10 Gungan          209.

  10. Найти самый распространенный цвет глаз персонажей вселенной Звездных
войн.

> starwars %>%
+     count(eye_color, sort = TRUE) %>%
+     head(1)
  eye_color     n
  <chr>     <int>
1 brown        21

  11. Подсчитать среднюю длину имени в каждой расе вселенной Звездных войн

> starwars %>%
+     group_by(species) %>%
+     summarise(avg_name_length = mean(nchar(name), na.rm = TRUE))
   species   avg_name_length
   <chr>               <dbl>
 1 Aleena              12   
 2 Besalisk            15   
 3 Cerean              12   
 4 Chagrian            10   
 5 Clawdite            10   
 6 Droid                4.83
 7 Dug                  7   
 8 Ewok                21   
 9 Geonosian           17   
10 Gungan              11.7 